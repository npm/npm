var registry = process.env.NPM_USER_REGISTRY = __dirname+'/user_registry'
var npa = require("../npa.js")
var path = require("path")

require("tap").test("user_registry", function (t) {
  t.setMaxListeners(999)

  var tests = {
    "npa": {
      name: null,
      type: "local",
      spec: path.resolve(registry+'/npa'),
      raw: "npa"
    },
    "./npa": {
      name: null,
      type: "local",
      spec: path.resolve(__dirname+'/npa'),
      raw: "./npa"
    }
  }

  Object.keys(tests).forEach(function (arg) {
    var res = npa(arg)
    t.type(res, "Result", arg + " is a result")
    t.has(res, tests[arg], arg + " matches expectations")
  })

  t.end()
})
